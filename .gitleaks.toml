# Gitleaks configuration for secret scanning
title = "Delivery System Secret Detection"

[extend]
# Use default rules
useDefault = true

# Additional rules can be added here
[[rules]]
id = "custom-hardcoded-password"
description = "Hardcoded password detected"
regex = '''password\s*[=:]\s*['"]?[a-zA-Z0-9]{8,}['"]?'''
tags = ["password", "hardcoded"]

[[rules]]
id = "custom-api-key"
description = "API key detected"
regex = '''api[_-]?key\s*[=:]\s*['"]?[a-zA-Z0-9]{20,}['"]?'''
tags = ["api-key", "hardcoded"]

[[rules]]
id = "custom-secret-key"
description = "Secret key detected"
regex = '''secret[_-]?key\s*[=:]\s*['"]?[a-zA-Z0-9]{20,}['"]?'''
tags = ["secret", "hardcoded"]

[[rules]]
id = "custom-database-url"
description = "Database URL with password detected"
regex = '''(mysql|postgres|mongodb|redis)://[^:]+:[^@]+@[^/]+'''
tags = ["database", "password", "url"]

# Exclude patterns (false positives)
[allowlist]
description = "Allowlist for known false positives"
paths = [
  '''\.env\.example''',
  '''\.env\.template''',
  '''\.md$''',
  '''\.txt$''',
  '''LICENSE''',
  '''\.github/workflows/secret-scan\.yml''',
  '''\.gitleaks\.toml''',
  '''node_modules/''',
  '''dist/''',
  '''build/''',
  '''target/''',
  '''\.gradle/''',
  '''\.idea/''',
  '''\.lock$''',
]

commits = [
  "Initial commit",
  "Update README",
]

regexes = [
  '''example\.com''',
  '''test.*password''',
  '''placeholder.*key''',
]
